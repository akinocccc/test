name: Auto-Assign

on:
  issues:
    types: [opened, edited]
  pull_request:
    types: [opened, edited]

jobs:
  add-assigness:
    runs-on: ubuntu-latest
    steps:
      - uses: wow-actions/auto-assign@v3
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          reviewers: |
            akinocccc
            material-release-bot
          assignees: akinocccc, material-release-bot
          addReviewers: true
          addAssignees: true
          numberOfReviewers: 1
          numberOfAssignees: 1
          skipKeywords: wip, draft
        

      - name: Add assigness
        if: steps.collaborators.outputs.data.collaborators != ''
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'add-assignees'
          token: ${{ secrets.GITHUB_TOKEN }}
          issue-number: ${{ github.event.issue.number }}
          assignees: ${{ steps.assignees.outputs.collaborators }}

      - run: |
          collaborators=${{ steps.assignees.outputs.collaborators }}
          collaboratorstring=${collaborators//,/ @}
          echo "::set-output name=string::@$collaboratorstring"
        id: template

      - name: Notification
        if: steps.assignees.outputs.collaborators != ''
        uses: actions-cool/maintain-one-comment@v2.0.0
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          body: |
            ♥️ Please ${{ steps.template.outputs.string }} to confirm the issue as soon as possible. After confirmation, please reply to @${{ github.event.issue.user.login }} with the next step plan and the estimated time needed.
            <!-- AUTO_ASSIGENEES_NOTIFY_HOOK -->
          number: ${{ github.event.issue.number }}
          body-include: "<!-- AUTO_ASSIGENEES_NOTIFY_HOOK -->"